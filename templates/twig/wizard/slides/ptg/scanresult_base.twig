{% extends 'wizard/slides/common/base.twig' %}

{% block slide_body %}
	{{ slideMacros.slideTitle( data.context_sing~' Guard Scan Results' ) }}

	{% if data.result|length == 0 %}
		<p>There were no files discovered that need your attention.</p>
	{% else %}
		<p>{{ data.result|length }} {{ data.context_sing }}(s) that need your attention.</p>

		<div id="accord{{ data.context_sing }}" class="scan-results-accordian">
		{% set resultCounter = 0 %}
			{% for item_name,item_res in data.result %}
				{% set resultCounter = resultCounter + 1 %}

				<div class="card">
				<div class="card-header">
					<h5 class="mb-0">
						<button class="btn btn-link btn-block text-left collapsed"
								data-toggle="collapse" data-target="#coll{{ resultCounter }}">
							{{ data.context_sing }}: {{ item_name }}
						</button>
					</h5>
				</div>

				<div id="coll{{ resultCounter }}" class="collapse" data-parent="#accord{{ data.context_sing }}">
				  <div class="card-body">
					  {% if item_res.different is defined %}
						  <div class="indent_slight">
							  <h6>Modified Files: {{ item_res.different|length }}</h6>
							  {% for file in item_res.different %}
								  <li><code class="filepath">{{ file }}</code></li>
							  {% endfor %}
						  </div>
					  {% endif %}

					  {% if item_res.missing is defined %}
						  <div class="indent_slight">
							  <h6>Missing Files: {{ item_res.missing|length }}</h6>
							  {% for file in item_res.missing %}
								  <li><code class="filepath">{{ file }}</code></li>
							  {% endfor %}
						  </div>
					  {% endif %}

					  {% if item_res.unrecognised is defined %}
						  <div class="indent_slight">
							  <h6>Unrecognised Files: {{ item_res.unrecognised|length }}</h6>
							  {% for file in item_res.unrecognised %}
								  <li><code class="filepath">{{ file }}</code></li>
							  {% endfor %}
						  </div>
					  {% endif %}
				  </div>
				</div>
				<div class="card-footer">
					<form class="icwp-wizard-form">

						<div class="form-check form-check-inline">
							<input class="form-check-input"
								   type="radio"
								   name="ptgaction"
								   id="ptgaction1"
							{% if item_res.flags.can_reinstall %}
							{% else %}
								disabled
							{% endif %}
								   value="reinstall" />
							<label class="form-check-label" for="ptgaction1">Re-Install / Upgrade</label>
						</div>

						<div class="form-check form-check-inline">
							<input class="form-check-input"
								   type="radio"
								   name="ptgaction"
								   id="ptgaction2"
								   value="deactivate" >
							<label class="form-check-label" for="ptgaction2">Deactivate</label>
						</div>

						<div class="form-check form-check-inline">
							<input class="form-check-input"
								   type="radio"
								   name="ptgaction"
								   id="ptgaction3"
								   value="ignore" >
							<label class="form-check-label" for="ptgaction3">Ignore Changes</label>
						</div>
						<button type="submit" class="btn btn-warning mb-2">Run Selected Action</button>
						{{ slideMacros.formInput_Hidden( 'wizard-step', 'ptg_assetaction' ) }}
						{{ slideMacros.formInput_Hidden( 'slug', item_res.flags.slug ) }}
						{{ slideMacros.formInput_Hidden( 'context', data.context ) }}
					</form>
				</div>
			  </div>
			{% endfor %}
		</div>

	{% endif %}

{% endblock %}