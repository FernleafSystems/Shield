<div class="row insights_widget" id="SectionScanResultsPtg">
	<div class="col-12">
		<div class="card card-scan_results mt-4">
			<div class="card-header">
				<h5 class="card-title">Plugin / Theme Guard [ {{ scanvars.count }} ]</h5>
				<h6 class="card-subtitle mb-2 text-muted">
					Tracks changes to important files within active Plugins and Themes
				</h6>
			</div>
			<div class="card-body">
				{% for asset_slug,asset_data in scanvars.assets_plugins %}
					<div class="row">
						<div class="col-md-4">
							<div class="ptg-asset-summary">
								<p><strong>{{ asset_data.name }}</strong> <small>(v{{ asset_data.version }})</small></p>
								<ul>
									<li>{{ scanvars.strings.files_with_problems }}: {{ asset_data.count_files }}</li>
									<li>{{ scanvars.strings.root_dir }}: <code>{{ asset_data.root_dir }}</code></li>
									<li>{{ scanvars.strings.date_snapshot }}: {{ asset_data.date_snapshot }}</li>
								</ul>
								<div>
									<button class="btn btn-sm btn-primary"
											{% if asset_data.can_reinstall %}
											{% else %}
												disabled="disabled"
											{% endif %}
									>
										{% if asset_data.has_update %}
											{{ scanvars.strings.update }}
										{% else %}
											{{ scanvars.strings.reinstall }}
										{% endif %}
									</button>

									<button class="btn btn-sm btn-info"
									>{{ scanvars.strings.accept }}</button>

									<button class="btn btn-sm btn-warning"
											{% if asset_data.can_deactivate %}
											{% else %}
												disabled="disabled"
											{% endif %}
									>{{ scanvars.strings.deactivate }}</button>
								</div>
							</div>
						</div>
						<div class="col-md-8">
							<div class="scan-table-for-slug" data-slug="{{ asset_slug }}"></div>
						</div>
					</div>
				{% endfor %}


				{% for asset_slug,asset_data in scanvars.assets_themes %}
					<div class="row">
						<div class="col-md-4">
							<div class="ptg-asset-summary">
								<p><strong>{{ asset_data.name }}</strong> <small>(v{{ asset_data.version }})</small></p>
								<ul>
									<li>{{ scanvars.strings.files_with_problems }}: {{ asset_data.count_files }}</li>
									<li>{{ scanvars.strings.root_dir }}: <code>{{ asset_data.root_dir }}</code></li>
									<li>{{ scanvars.strings.date_snapshot }}: {{ asset_data.date_snapshot }}</li>
								</ul>
								<div>
									<button class="btn btn-sm btn-primary"
											{% if asset_data.can_reinstall %}
											{% else %}
												disabled="disabled"
											{% endif %}
									>{{ scanvars.strings.reinstall }}</button>

									<button class="btn btn-sm btn-info"
									>{{ scanvars.strings.accept }}</button>
								</div>
							</div>
						</div>
						<div class="col-md-8">
							<div class="scan-table-for-slug" data-slug="{{ asset_slug }}"></div>
						</div>
					</div>
				{% endfor %}

			</div>
			<div class="card-footer">
				{{ scanvars.last_scan_at }}
			</div>
		</div>
	</div>
</div>
<script>
	jQuery( 'div.scan-table-for-slug' ).each( function () {
		var $oDiv = jQuery( this );
		$oDiv.icwpWpsfAjaxTable(
			{
				'ajax_render':{{ ajax.render_table_scan|raw }},
				'req_params': {
					'fScan': 'ptg',
					'fSlug': $oDiv.data( 'slug' )
				}
			}
		);
	} );
</script>